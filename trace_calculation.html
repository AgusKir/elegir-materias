<!DOCTYPE html>
<html>
<head><title>Trace Calculation</title></head>
<body>
    <h1>Trace Calculation for 3667</h1>
    <pre id="output"></pre>
    <script src="classes.js?v=7"></script>
    <script>
        let output = '';
        
        const allSubjects = [];
        for (let i = 3621; i <= 3680; i++) allSubjects.push(i);
        allSubjects.push(901, 902, 903, 904, 911, 912);
        
        const excluded = new Set([901, 902, 903, 904, 3667, 3671]);
        const completed = allSubjects.filter(id => !excluded.has(id));
        
        // Semester 1
        const plan1 = new PlanDeEstudios();
        plan1.cargarMateriasDesdeTexto(listado, completed);
        plan1.cargarNombresDesdeTexto(tabla_nombres);
        plan1.calcularYGuardarLongitudes(1);
        
        output += '=== Semester 1 (Primero) ===\n';
        output += `cuatrisMinimos: ${plan1.cuatrisMinimosHastaRecibirse(1)}\n`;
        output += `3667 valor_corchete: ${plan1.datos_materias[3667].valor_corchete} (expected 2)\n`;
        output += `3667 cuatrimestre: ${plan1.datos_materias[3667].cuatrimestre}\n\n`;
        
        // Semester 2
        const plan2 = new PlanDeEstudios();
        plan2.cargarMateriasDesdeTexto(listado, completed);
        plan2.cargarNombresDesdeTexto(tabla_nombres);
        plan2.calcularYGuardarLongitudes(2);
        
        output += '=== Semester 2 (Segundo) ===\n';
        output += `cuatrisMinimos: ${plan2.cuatrisMinimosHastaRecibirse(2)}\n`;
        output += `3667 valor_corchete: ${plan2.datos_materias[3667].valor_corchete} (expected 1)\n`;
        output += `3667 cuatrimestre: ${plan2.datos_materias[3667].cuatrimestre}\n\n`;
        
        output += '=== Analysis ===\n';
        output += 'Semester 1: 3667 is 1, but should be 2 (need to subtract 1 from cantMateriasDespues)\n';
        output += 'Semester 2: 3667 is 2, but should be 1 (cantMateriasDespues is correct)\n';
        output += 'This suggests the gap should be REMOVED for semester 1, not added!\n';
        
        document.getElementById('output').textContent = output;
    </script>
</body>
</html>
