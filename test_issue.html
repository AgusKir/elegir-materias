<!DOCTYPE html>
<html>
<head>
    <title>Test Issue Cases</title>
</head>
<body>
    <h1>Testing Issue Cases</h1>
    <pre id="output"></pre>
    
    <script src="classes.js"></script>
    <script>
        let output = '';
        
        // Test Case 1: All but 901, 902, 903, 904, 3667, and 3671 selected, semester Primero
        output += '=== TEST CASE 1: All but 901, 902, 903, 904, 3667, 3671, semester Primero ===\n';
        const allSubjects = [];
        for (let i = 3621; i <= 3680; i++) allSubjects.push(i);
        allSubjects.push(911, 912);
        const excludedSet1 = new Set([901, 902, 903, 904, 3667, 3671]);
        const completedCase1 = allSubjects.filter(id => !excludedSet1.has(id));
        
        const plan1 = new PlanDeEstudios();
        plan1.cargarMateriasDesdeTexto(listado, completedCase1);
        plan1.cargarNombresDesdeTexto(tabla_nombres);
        plan1.calcularYGuardarLongitudes(1); // semester = 1 (Primero)
        
        output += 'Expected:\n901 - 1\n3667 - 2\n\n';
        output += 'Actual:\n';
        if (plan1.datos_materias[901]) {
            output += `901 - ${plan1.datos_materias[901].valor_corchete}\n`;
        }
        if (plan1.datos_materias[3667]) {
            output += `3667 - ${plan1.datos_materias[3667].valor_corchete}\n`;
        }
        output += '\n';
        
        // Test Case 2: Same setup, semester Segundo
        output += '=== TEST CASE 2: All but 901, 902, 903, 904, 3667, 3671, semester Segundo ===\n';
        const plan2 = new PlanDeEstudios();
        plan2.cargarMateriasDesdeTexto(listado, completedCase1);
        plan2.cargarNombresDesdeTexto(tabla_nombres);
        plan2.calcularYGuardarLongitudes(2); // semester = 2 (Segundo)
        
        output += 'Expected:\n901 - 1\n3667 - 1 (ISSUE: currently showing 2)\n\n';
        output += 'Actual:\n';
        if (plan2.datos_materias[901]) {
            output += `901 - ${plan2.datos_materias[901].valor_corchete}\n`;
        }
        if (plan2.datos_materias[3667]) {
            output += `3667 - ${plan2.datos_materias[3667].valor_corchete}\n`;
        }
        output += '\n';
        
        // Test Case 3: Select 901 and 902, semester Segundo
        output += '=== TEST CASE 3: All but 903, 904, 3667, 3671, semester Segundo ===\n';
        const excludedSet3 = new Set([903, 904, 3667, 3671]);
        const completedCase3 = allSubjects.filter(id => !excludedSet3.has(id));
        completedCase3.push(901, 902);
        
        const plan3 = new PlanDeEstudios();
        plan3.cargarMateriasDesdeTexto(listado, completedCase3);
        plan3.cargarNombresDesdeTexto(tabla_nombres);
        plan3.calcularYGuardarLongitudes(2); // semester = 2 (Segundo)
        
        output += 'Expected:\n903 - 2\n3667 - 1 (ISSUE: currently showing 0)\n\n';
        output += 'Actual:\n';
        if (plan3.datos_materias[903]) {
            output += `903 - ${plan3.datos_materias[903].valor_corchete}\n`;
        }
        if (plan3.datos_materias[3667]) {
            output += `3667 - ${plan3.datos_materias[3667].valor_corchete}\n`;
        }
        output += '\n';
        
        // Test Case 4: Select 901, 902, 904, semester Segundo
        output += '=== TEST CASE 4: All but 3667, 3671, semester Segundo ===\n';
        const excludedSet4 = new Set([3667, 3671]);
        const completedCase4 = allSubjects.filter(id => !excludedSet4.has(id));
        completedCase4.push(901, 902, 903, 904);
        
        const plan4 = new PlanDeEstudios();
        plan4.cargarMateriasDesdeTexto(listado, completedCase4);
        plan4.cargarNombresDesdeTexto(tabla_nombres);
        plan4.calcularYGuardarLongitudes(2); // semester = 2 (Segundo)
        
        output += 'Expected:\n904 - 4\n3667 - 2 (ISSUE: currently doesn\'t appear)\n\n';
        output += 'Actual:\n';
        if (plan4.datos_materias[904]) {
            output += `904 - ${plan4.datos_materias[904].valor_corchete}\n`;
        }
        if (plan4.datos_materias[3667]) {
            output += `3667 - ${plan4.datos_materias[3667].valor_corchete}\n`;
        }
        output += '\n';
        
        // Debug info for path analysis
        output += '=== DEBUG INFO for 3667 in Test Case 2 ===\n';
        output += 'Path from 3667:\n';
        const pathFrom3667 = plan2.encontrarCaminoMasLargoDesde(3667);
        output += pathFrom3667.join(' -> ') + '\n';
        output += `Length: ${pathFrom3667.length}\n\n`;
        
        output += 'Path to 3667:\n';
        const pathTo3667 = plan2.encontrarCaminoMasLargoHasta(3667);
        output += pathTo3667.join(' -> ') + '\n';
        output += `Length: ${pathTo3667.length}\n\n`;
        
        output += 'Semester-aware paths:\n';
        const semPathFrom = plan2.encontrarCaminoMasSemestresDesde(3667);
        const semPathTo = plan2.encontrarCaminoMasSemestresHasta(3667);
        output += `From: ${semPathFrom.join(' -> ')}\n`;
        output += `Semesters from: ${plan2.contarSemestresEnCamino(semPathFrom, true)}\n`;
        output += `To: ${semPathTo.join(' -> ')}\n`;
        output += `Semesters to: ${plan2.contarSemestresEnCamino(semPathTo, true)}\n\n`;
        
        output += `cuatrisMinimos: ${plan2.cuatrisMinimosHastaRecibirse(2)}\n`;
        output += `Has 3671: ${plan2.materias[3671] ? 'yes' : 'no'}\n`;
        output += `3667 reaches 3671: ${plan2.esAlcanzableDesde(3667, 3671)}\n`;
        
        document.getElementById('output').textContent = output;
    </script>
</body>
</html>
