<!DOCTYPE html>
<html>
<head>
    <title>Debug After 901</title>
</head>
<body>
    <h1>Debug after checking 901</h1>
    <pre id="output"></pre>
    
    <script src="classes.js"></script>
    <script>
        const allSubjectIds = [
            3621, 3622, 3623, 3624, 3625, 3626, 3627, 3628, 3629, 3630,
            3631, 3632, 3633, 3634, 3635, 3636, 3637, 3638, 3639, 3640,
            3641, 3642, 3643, 3644, 3645, 3646, 3647, 3648, 3649, 3650,
            3651, 3652, 3653, 3654, 3655, 3656, 3657, 3658, 3659, 3660,
            3661, 3662, 3663, 3664, 3665, 3666, 3668, 3669, 3670,
            3675, 3676, 3677, 3678, 3679, 3680,
            901, 902, 903, 904, 911, 912
        ];
        
        // 901 is completed now
        const notCompleted = [902, 903, 904, 3667, 3671];
        const completedSubjects = allSubjectIds.filter(id => !notCompleted.includes(id));
        
        const plan = new PlanDeEstudios();
        plan.cargarMateriasDesdeTexto(listado, completedSubjects);
        plan.cargarNombresDesdeTexto(tabla_nombres);
        plan.calcularYGuardarLongitudes(1);
        
        let output = 'After checking 901:\n';
        output += '==================\n\n';
        
        output += 'Paths:\n';
        const longestPath = plan.encontrarCaminoMasLargo();
        const longestSemesters = plan.contarSemestresEnCamino(longestPath);
        output += `Longest: ${longestPath.join('->')} (${longestPath.length} subjects, ${longestSemesters} semesters)\n`;
        
        const path3667 = plan.encontrarCaminoMasLargoDesde(3667);
        const semesters3667 = plan.contarSemestresEnCamino(path3667);
        output += `From 3667: ${path3667.join('->')} (${path3667.length} subjects, ${semesters3667} semesters)\n\n`;
        
        output += 'cuatrisMinimosBase: ' + plan.cuatrisMinimosHastaRecibirse(1) + '\n\n';
        
        output += '902 calculation:\n';
        const camino902Hasta = plan.encontrarCaminoMasLargoHasta(902);
        const camino902Desde = plan.encontrarCaminoMasLargoDesde(902);
        output += `Path to 902: ${camino902Hasta.join('->')} (${camino902Hasta.length} subjects, ${plan.contarSemestresEnCamino(camino902Hasta)} semesters)\n`;
        output += `Path from 902: ${camino902Desde.join('->')} (${camino902Desde.length} subjects, ${plan.contarSemestresEnCamino(camino902Desde)} semesters)\n`;
        output += `cantMateriasAntes: ${plan.contarSemestresEnCamino(camino902Hasta) - 1}\n`;
        output += `cantMateriasDespues: ${plan.contarSemestresEnCamino(camino902Desde) - 1}\n`;
        output += `valor_corchete: ${plan.datos_materias[902].valor_corchete}\n`;
        output += `Expected: 2\n\n`;
        
        output += '3667 calculation:\n';
        const camino3667Hasta = plan.encontrarCaminoMasLargoHasta(3667);
        const camino3667Desde = plan.encontrarCaminoMasLargoDesde(3667);
        output += `Path to 3667: ${camino3667Hasta.join('->')} (${camino3667Hasta.length} subjects, ${plan.contarSemestresEnCamino(camino3667Hasta)} semesters)\n`;
        output += `Path from 3667: ${camino3667Desde.join('->')} (${camino3667Desde.length} subjects, ${plan.contarSemestresEnCamino(camino3667Desde)} semesters)\n`;
        output += `cantMateriasAntes: ${plan.contarSemestresEnCamino(camino3667Hasta) - 1}\n`;
        output += `cantMateriasDespues: ${plan.contarSemestresEnCamino(camino3667Desde) - 1}\n`;
        output += `valor_corchete: ${plan.datos_materias[3667].valor_corchete}\n`;
        output += `Expected: 2\n\n`;
        
        output += 'Analysis:\n';
        output += 'The longest path is 902->903->904 (3 subjects, 3 semesters).\n';
        output += 'The path 3667->3671 is 2 subjects, 3 semesters.\n';
        output += 'So cuatrisMinimosBase should be 3.\n';
        output += 'But the expected values suggest cuatrisMinimosBase should be 4!\n\n';
        output += 'Why? Because of the semester parity constraint!\n';
        output += 'If we\'re in semester 1 (Primero):\n';
        output += '  - Semester 1: Can take 3667, 902\n';
        output += '  - Semester 2: Can take 903\n';
        output += '  - Semester 3: Can start 3671 (Primero), can take 904\n';
        output += '  - Semester 4: Continue 3671\n';
        output += 'Total: 4 semesters!\n\n';
        output += 'So the issue is that cuatrisMinimosBase needs to account for the parity constraint.\n';
        
        document.getElementById('output').textContent = output;
    </script>
</body>
</html>
