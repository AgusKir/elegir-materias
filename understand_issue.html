<!DOCTYPE html>
<html>
<head><title>Understand Issue</title></head>
<body>
    <h1>Understanding the Issue</h1>
    <pre id="output"></pre>
    <script src="classes.js?v=4"></script>
    <script>
        let output = '';
        
        // From the issue: "all but 901, 902, 903, 904, 3667, and 3671 selected"
        const allSubjects = [];
        for (let i = 3621; i <= 3680; i++) allSubjects.push(i);
        allSubjects.push(901, 902, 903, 904, 911, 912);
        
        const excluded1 = new Set([901, 902, 903, 904, 3667, 3671]);
        const completed1 = allSubjects.filter(id => !excluded1.has(id));
        
        output += '=== Test from issue: All but 901, 902, 903, 904, 3667, 3671 ===\n\n';
        output += 'Remaining subjects: 901, 902, 903, 904, 3667, 3671\n\n';
        
        // Check dependencies
        output += 'Dependencies:\n';
        output += '901: none\n';
        output += '902: 901\n';
        output += '903: 902\n';
        output += '904: 903\n';
        output += '3667: 3642, 3661\n';
        output += '3671: 3667, 3659, 3660, 3656\n\n';
        
        // Semester 1
        const plan1 = new PlanDeEstudios();
        plan1.cargarMateriasDesdeTexto(listado, completed1);
        plan1.cargarNombresDesdeTexto(tabla_nombres);
        plan1.calcularYGuardarLongitudes(1);
        
        output += 'Semester 1 (Primero):\n';
        output += `901: ${plan1.datos_materias[901]?.valor_corchete || 'N/A'} (expected 1)\n`;
        output += `3667: ${plan1.datos_materias[3667]?.valor_corchete || 'N/A'} (expected 2)\n\n`;
        
        // Semester 2
        const plan2 = new PlanDeEstudios();
        plan2.cargarMateriasDesdeTexto(listado, completed1);
        plan2.cargarNombresDesdeTexto(tabla_nombres);
        plan2.calcularYGuardarLongitudes(2);
        
        output += 'Semester 2 (Segundo):\n';
        output += `901: ${plan2.datos_materias[901]?.valor_corchete || 'N/A'} (expected 1)\n`;
        output += `3667: ${plan2.datos_materias[3667]?.valor_corchete || 'N/A'} (expected 1, currently showing 2)\n\n`;
        
        output += 'Debug for semester 2:\n';
        output += `cuatrisMinimos: ${plan2.cuatrisMinimosHastaRecibirse(2)}\n`;
        
        // Analyze 3667's path
        const pathFrom3667 = plan2.encontrarCaminoMasSemestresDesde(3667);
        const pathTo3667 = plan2.encontrarCaminoMasSemestresHasta(3667);
        output += `Path from 3667: ${pathFrom3667.join(' -> ')}\n`;
        output += `Semesters from 3667: ${plan2.contarSemestresEnCamino(pathFrom3667, true)}\n`;
        output += `Path to 3667: ${pathTo3667.join(' -> ')}\n`;
        output += `Semesters to 3667: ${plan2.contarSemestresEnCamino(pathTo3667, true)}\n`;
        
        const semBefore = plan2.contarSemestresEnCamino(pathTo3667, true) - 1;
        const semAfter = plan2.contarSemestresEnCamino(pathFrom3667, true) - 1;
        const cuatMin = plan2.cuatrisMinimosHastaRecibirse(2);
        output += `\nCalculation: ${cuatMin} - (${semBefore} + ${semAfter}) = ${cuatMin - (semBefore + semAfter)}\n`;
        
        document.getElementById('output').textContent = output;
    </script>
</body>
</html>
