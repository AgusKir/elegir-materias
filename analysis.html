<!DOCTYPE html>
<html>
<head><title>Analysis</title></head>
<body>
    <h1>Deep Analysis</h1>
    <pre id="output"></pre>
    <script src="classes.js"></script>
    <script>
        let output = '';
        
        // Create a simple test: only 3667 and 3671 remaining
        const allSubjects = [];
        for (let i = 3621; i <= 3680; i++) allSubjects.push(i);
        allSubjects.push(901, 902, 903, 904, 911, 912);
        
        const excludedSimple = new Set([3667, 3671]);
        const completedSimple = allSubjects.filter(id => !excludedSimple.has(id));
        
        output += '=== SIMPLE CASE: Only 3667 and 3671 left ===\n\n';
        
        // Semester 1 (Primero)
        const plan1 = new PlanDeEstudios();
        plan1.cargarMateriasDesdeTexto(listado, completedSimple);
        plan1.cargarNombresDesdeTexto(tabla_nombres);
        plan1.calcularYGuardarLongitudes(1);
        
        output += 'Semester 1 (Primero):\n';
        output += `cuatrisMinimos: ${plan1.cuatrisMinimosHastaRecibirse(1)}\n`;
        output += `3667 valor_corchete: ${plan1.datos_materias[3667].valor_corchete}\n`;
        output += `3667 cuatrimestre: ${plan1.datos_materias[3667].cuatrimestre}\n`;
        output += `3671 valor_corchete: ${plan1.datos_materias[3671].valor_corchete}\n`;
        output += `3671 cuatrimestre: ${plan1.datos_materias[3671].cuatrimestre}\n`;
        
        const pathFrom3667_s1 = plan1.encontrarCaminoMasSemestresDesde(3667);
        const pathTo3667_s1 = plan1.encontrarCaminoMasSemestresHasta(3667);
        output += `Path from 3667: ${pathFrom3667_s1.join(' -> ')}\n`;
        output += `Semesters from: ${plan1.contarSemestresEnCamino(pathFrom3667_s1, true)}\n`;
        output += `Path to 3667: ${pathTo3667_s1.join(' -> ')}\n`;
        output += `Semesters to: ${plan1.contarSemestresEnCamino(pathTo3667_s1, true)}\n\n`;
        
        // Semester 2 (Segundo)
        const plan2 = new PlanDeEstudios();
        plan2.cargarMateriasDesdeTexto(listado, completedSimple);
        plan2.cargarNombresDesdeTexto(tabla_nombres);
        plan2.calcularYGuardarLongitudes(2);
        
        output += 'Semester 2 (Segundo):\n';
        output += `cuatrisMinimos: ${plan2.cuatrisMinimosHastaRecibirse(2)}\n`;
        output += `3667 valor_corchete: ${plan2.datos_materias[3667].valor_corchete}\n`;
        output += `3667 cuatrimestre: ${plan2.datos_materias[3667].cuatrimestre}\n`;
        output += `3671 valor_corchete: ${plan2.datos_materias[3671].valor_corchete}\n`;
        output += `3671 cuatrimestre: ${plan2.datos_materias[3671].cuatrimestre}\n`;
        
        const pathFrom3667_s2 = plan2.encontrarCaminoMasSemestresDesde(3667);
        const pathTo3667_s2 = plan2.encontrarCaminoMasSemestresHasta(3667);
        output += `Path from 3667: ${pathFrom3667_s2.join(' -> ')}\n`;
        output += `Semesters from: ${plan2.contarSemestresEnCamino(pathFrom3667_s2, true)}\n`;
        output += `Path to 3667: ${pathTo3667_s2.join(' -> ')}\n`;
        output += `Semesters to: ${plan2.contarSemestresEnCamino(pathTo3667_s2, true)}\n\n`;
        
        output += '=== EXPECTED LOGIC ===\n';
        output += 'When starting in Segundo (semester 2):\n';
        output += '- Current semester: 2 (Segundo)\n';
        output += '- 3667 can be taken: semester 2\n';
        output += '- 3671 requires 3667, so earliest it can START is semester 3 (Primero)\n';
        output += '- 3671 takes 2 semesters (3 and 4), ending in semester 4\n';
        output += '- Total semesters needed: 4\n';
        output += '- For 3667: semesters_before=0, semesters_after=3 (to 3671 via path 3667->3671)\n';
        output += '  valor_corchete = 4 - (0 + 3) = 1\n';
        output += '- For 3671: semesters_before=1 (3667), semesters_after=0\n';
        output += '  But 3671 starts in semester 3 and ends in semester 4\n';
        output += '  valor_corchete should reflect it can start in semester 3\n\n';
        
        output += 'When starting in Primero (semester 1):\n';
        output += '- Current semester: 1 (Primero)\n';
        output += '- 3667 can be taken: semester 1\n';
        output += '- 3671 requires 3667, so earliest it can START is semester 3 (next Primero after 1)\n';
        output += '- 3671 takes 2 semesters (3 and 4), ending in semester 4\n';
        output += '- Total semesters needed: 4\n';
        output += '- For 3667: semesters_before=0, semesters_after=3\n';
        output += '  valor_corchete = 4 - (0 + 3) = 1? Or should it be 2?\n\n';
        
        document.getElementById('output').textContent = output;
    </script>
</body>
</html>
